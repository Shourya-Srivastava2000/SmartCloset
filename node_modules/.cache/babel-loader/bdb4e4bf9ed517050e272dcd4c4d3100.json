{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _downshift = require('downshift');\n\nvar _downshift2 = _interopRequireDefault(_downshift);\n\nvar _emotionTheming = require('emotion-theming');\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _suggestions = require('@appbaseio/reactivecore/lib/utils/suggestions');\n\nvar _suggestions2 = _interopRequireDefault(_suggestions);\n\nvar _causes = require('@appbaseio/reactivecore/lib/utils/causes');\n\nvar _causes2 = _interopRequireDefault(_causes);\n\nvar _Title = require('../../styles/Title');\n\nvar _Title2 = _interopRequireDefault(_Title);\n\nvar _Input = require('../../styles/Input');\n\nvar _Input2 = _interopRequireDefault(_Input);\n\nvar _CancelSvg = require('../shared/CancelSvg');\n\nvar _CancelSvg2 = _interopRequireDefault(_CancelSvg);\n\nvar _SearchSvg = require('../shared/SearchSvg');\n\nvar _SearchSvg2 = _interopRequireDefault(_SearchSvg);\n\nvar _InputIcon = require('../../styles/InputIcon');\n\nvar _InputIcon2 = _interopRequireDefault(_InputIcon);\n\nvar _Container = require('../../styles/Container');\n\nvar _Container2 = _interopRequireDefault(_Container);\n\nvar _utils = require('../../utils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Text = (0, _emotionTheming.withTheme)(function (props) {\n  return _react2.default.createElement('span', {\n    className: 'trim',\n    style: {\n      color: props.primary ? props.theme.colors.primaryColor : props.theme.colors.textColor\n    }\n  }, props.children);\n});\n\nvar CategorySearch = function (_Component) {\n  _inherits(CategorySearch, _Component);\n\n  function CategorySearch(props) {\n    _classCallCheck(this, CategorySearch);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.state = {\n      currentValue: '',\n      suggestions: [],\n      isOpen: false\n    };\n    _this.internalComponent = props.componentId + '__internal';\n    _this.locked = false;\n    props.setQueryListener(props.componentId, props.onQueryChange, null);\n    return _this;\n  }\n\n  CategorySearch.prototype.componentWillMount = function componentWillMount() {\n    this.props.addComponent(this.props.componentId, 'CATEGORYSEARCH');\n    this.props.addComponent(this.internalComponent);\n\n    if (this.props.highlight) {\n      var queryOptions = CategorySearch.highlightQuery(this.props) || {};\n      queryOptions.size = 20;\n      this.props.setQueryOptions(this.props.componentId, queryOptions);\n    } else {\n      this.props.setQueryOptions(this.props.componentId, {\n        size: 20\n      });\n    }\n\n    this.setReact(this.props);\n    var aggsQuery = this.getAggsQuery(this.props.categoryField);\n    this.props.setQueryOptions(this.internalComponent, aggsQuery, false);\n\n    if (this.props.selectedValue) {\n      this.setValue(this.props.selectedValue, true);\n    } else if (this.props.defaultSelected) {\n      this.setValue(this.props.defaultSelected, true);\n    }\n  };\n\n  CategorySearch.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    var _this2 = this;\n\n    (0, _helper.checkSomePropChange)(this.props, nextProps, ['highlight', 'dataField', 'highlightField'], function () {\n      var queryOptions = CategorySearch.highlightQuery(nextProps) || {};\n      queryOptions.size = 20;\n\n      _this2.props.setQueryOptions(nextProps.componentId, queryOptions);\n    });\n    (0, _helper.checkPropChange)(this.props.react, nextProps.react, function () {\n      return _this2.setReact(nextProps);\n    });\n\n    if (Array.isArray(nextProps.suggestions) && this.state.currentValue.trim().length) {\n      // shallow check allows us to set suggestions even if the next set\n      // of suggestions are same as the current one\n      if (this.props.suggestions !== nextProps.suggestions) {\n        this.setState({\n          suggestions: this.onSuggestions(nextProps.suggestions)\n        });\n      }\n    }\n\n    (0, _helper.checkSomePropChange)(this.props, nextProps, ['fieldWeights', 'fuzziness', 'queryFormat', 'dataField', 'categoryField'], function () {\n      _this2.updateQuery(nextProps.componentId, _this2.state.currentValue, nextProps);\n    });\n\n    if (this.props.defaultSelected !== nextProps.defaultSelected) {\n      this.setValue(nextProps.defaultSelected, true, nextProps);\n    } else if ( // since, selectedValue will be updated when currentValue changes,\n    // we must only check for the changes introduced by\n    // clear action from SelectedFilters component in which case,\n    // the currentValue will never match the updated selectedValue\n    this.props.selectedValue !== nextProps.selectedValue && this.state.currentValue !== nextProps.selectedValue) {\n      this.setValue(nextProps.selectedValue || '', true, nextProps);\n    }\n  };\n\n  CategorySearch.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.props.removeComponent(this.props.componentId);\n    this.props.removeComponent(this.internalComponent);\n  };\n\n  CategorySearch.prototype.render = function render() {\n    var _this3 = this;\n\n    var suggestionsList = [];\n    var finalSuggestionsList = [];\n    var _props = this.props,\n        theme = _props.theme,\n        themePreset = _props.themePreset,\n        renderSuggestions = _props.renderSuggestions,\n        categories = _props.categories; // filter out empty categories\n\n    var filteredCategories = categories.filter(function (category) {\n      return Boolean(category.key);\n    });\n\n    if (!this.state.currentValue && this.props.defaultSuggestions && this.props.defaultSuggestions.length) {\n      finalSuggestionsList = this.props.defaultSuggestions;\n    } else if (this.state.currentValue) {\n      suggestionsList = this.state.suggestions;\n    }\n\n    if (this.state.currentValue && this.state.suggestions.length && filteredCategories.length) {\n      var categorySuggestions = [{\n        label: this.state.currentValue + ' in all categories',\n        value: this.state.currentValue,\n        category: '*',\n        // no source object exists for category based suggestions\n        source: null\n      }, {\n        label: this.state.currentValue + ' in ' + filteredCategories[0].key,\n        value: this.state.currentValue,\n        category: filteredCategories[0].key,\n        source: null\n      }];\n\n      if (filteredCategories.length > 1) {\n        categorySuggestions = [].concat(categorySuggestions, [{\n          label: this.state.currentValue + ' in ' + filteredCategories[1].key,\n          value: this.state.currentValue,\n          category: filteredCategories[1].key,\n          source: null\n        }]);\n      }\n\n      finalSuggestionsList = [].concat(categorySuggestions, suggestionsList);\n    }\n\n    return _react2.default.createElement(_Container2.default, {\n      style: this.props.style,\n      className: this.props.className\n    }, this.props.title && _react2.default.createElement(_Title2.default, {\n      className: (0, _helper.getClassName)(this.props.innerClass, 'title') || null\n    }, this.props.title), this.props.defaultSuggestions || this.props.autosuggest ? _react2.default.createElement(_downshift2.default, _extends({\n      id: this.props.componentId + '-downshift',\n      onChange: this.onSuggestionSelected,\n      onStateChange: this.handleStateChange,\n      isOpen: this.state.isOpen,\n      itemToString: function itemToString(i) {\n        return i;\n      },\n      render: function render(_ref) {\n        var getInputProps = _ref.getInputProps,\n            getItemProps = _ref.getItemProps,\n            isOpen = _ref.isOpen,\n            highlightedIndex = _ref.highlightedIndex;\n        return _react2.default.createElement('div', {\n          className: _Input.suggestionsContainer\n        }, _react2.default.createElement(_Input2.default, _extends({\n          showClear: _this3.props.showClear,\n          id: _this3.props.componentId + '-input',\n          showIcon: _this3.props.showIcon,\n          iconPosition: _this3.props.iconPosition,\n          innerRef: _this3.props.innerRef\n        }, getInputProps({\n          className: (0, _helper.getClassName)(_this3.props.innerClass, 'input'),\n          placeholder: _this3.props.placeholder,\n          value: _this3.state.currentValue === null ? '' : _this3.state.currentValue,\n          onChange: _this3.onInputChange,\n          onBlur: _this3.props.onBlur,\n          onFocus: _this3.handleFocus,\n          onKeyPress: _this3.props.onKeyPress,\n          onKeyDown: function onKeyDown(e) {\n            return _this3.handleKeyDown(e, highlightedIndex);\n          },\n          onKeyUp: _this3.props.onKeyUp\n        }), {\n          themePreset: themePreset\n        })), _this3.renderIcons(), _this3.renderLoader(), renderSuggestions && renderSuggestions({\n          currentValue: _this3.state.currentValue,\n          isOpen: isOpen,\n          getItemProps: getItemProps,\n          highlightedIndex: highlightedIndex,\n          suggestions: _this3.props.suggestions,\n          categories: filteredCategories,\n          parsedSuggestions: suggestionsList\n        }), !renderSuggestions && isOpen && finalSuggestionsList.length ? _react2.default.createElement('ul', {\n          className: (0, _Input.suggestions)(themePreset, theme) + ' ' + (0, _helper.getClassName)(_this3.props.innerClass, 'list')\n        }, finalSuggestionsList.slice(0, 10).map(function (item, index) {\n          return _react2.default.createElement('li', _extends({}, getItemProps({\n            item: item\n          }), {\n            key: index + 1 + '-' + item.value,\n            style: {\n              backgroundColor: _this3.getBackgroundColor(highlightedIndex, index)\n            }\n          }), _react2.default.createElement(Text, {\n            primary: !!item.category\n          }, item.label));\n        })) : null);\n      }\n    }, this.props.downShiftProps)) : _react2.default.createElement('div', {\n      className: _Input.suggestionsContainer\n    }, _react2.default.createElement(_Input2.default, {\n      className: (0, _helper.getClassName)(this.props.innerClass, 'input'),\n      placeholder: this.props.placeholder,\n      value: this.state.currentValue ? this.state.currentValue : '',\n      onChange: this.onInputChange,\n      onBlur: this.props.onBlur,\n      onFocus: this.props.onFocus,\n      onKeyPress: this.props.onKeyPress,\n      onKeyDown: this.props.onKeyDown,\n      onKeyUp: this.props.onKeyUp,\n      autoFocus: this.props.autoFocus,\n      iconPosition: this.props.iconPosition,\n      showClear: this.props.showClear,\n      showIcon: this.props.showIcon,\n      innerRef: this.props.innerRef,\n      themePreset: themePreset\n    }), this.renderIcons()));\n  };\n\n  return CategorySearch;\n}(_react.Component);\n\nCategorySearch.highlightQuery = function (props) {\n  if (props.customHighlight) {\n    return props.customHighlight(props);\n  }\n\n  if (!props.highlight) {\n    return null;\n  }\n\n  var fields = {};\n  var highlightField = props.highlightField ? props.highlightField : props.dataField;\n\n  if (typeof highlightField === 'string') {\n    fields[highlightField] = {};\n  } else if (Array.isArray(highlightField)) {\n    highlightField.forEach(function (item) {\n      fields[item] = {};\n    });\n  }\n\n  return {\n    highlight: {\n      pre_tags: ['<mark>'],\n      post_tags: ['</mark>'],\n      fields: fields\n    }\n  };\n};\n\nCategorySearch.defaultQuery = function (value, props, category) {\n  var finalQuery = null;\n  var fields = void 0;\n\n  if (value) {\n    if (Array.isArray(props.dataField)) {\n      fields = props.dataField;\n    } else {\n      fields = [props.dataField];\n    }\n\n    finalQuery = {\n      bool: {\n        should: CategorySearch.shouldQuery(value, fields, props),\n        minimum_should_match: '1'\n      }\n    };\n\n    if (category && category !== '*') {\n      var _term;\n\n      finalQuery = [finalQuery, {\n        term: (_term = {}, _term[props.categoryField] = category, _term)\n      }];\n    }\n  }\n\n  if (value === '') {\n    finalQuery = {\n      match_all: {}\n    };\n  }\n\n  return finalQuery;\n};\n\nCategorySearch.shouldQuery = function (value, dataFields, props) {\n  var fields = dataFields.map(function (field, index) {\n    return '' + field + (Array.isArray(props.fieldWeights) && props.fieldWeights[index] ? '^' + props.fieldWeights[index] : '');\n  });\n\n  if (props.queryFormat === 'and') {\n    return [{\n      multi_match: {\n        query: value,\n        fields: fields,\n        type: 'cross_fields',\n        operator: 'and'\n      }\n    }, {\n      multi_match: {\n        query: value,\n        fields: fields,\n        type: 'phrase_prefix',\n        operator: 'and'\n      }\n    }];\n  }\n\n  return [{\n    multi_match: {\n      query: value,\n      fields: fields,\n      type: 'best_fields',\n      operator: 'or',\n      fuzziness: props.fuzziness ? props.fuzziness : 0\n    }\n  }, {\n    multi_match: {\n      query: value,\n      fields: fields,\n      type: 'phrase_prefix',\n      operator: 'or'\n    }\n  }];\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this4 = this;\n\n  this.getAggsQuery = function (field) {\n    var _aggs;\n\n    return {\n      aggs: (_aggs = {}, _aggs[field] = {\n        terms: {\n          field: field\n        }\n      }, _aggs)\n    };\n  };\n\n  this.setReact = function (props) {\n    var react = props.react;\n\n    if (react) {\n      var newReact = (0, _helper.pushToAndClause)(react, _this4.internalComponent);\n      props.watchComponent(props.componentId, newReact);\n    } else {\n      props.watchComponent(props.componentId, {\n        and: _this4.internalComponent\n      });\n    }\n  };\n\n  this.onSuggestions = function (searchSuggestions) {\n    if (_this4.props.onSuggestion) {\n      return searchSuggestions.map(function (suggestion) {\n        return _this4.props.onSuggestion(suggestion);\n      });\n    }\n\n    var fields = Array.isArray(_this4.props.dataField) ? _this4.props.dataField : [_this4.props.dataField];\n    return (0, _suggestions2.default)(fields, searchSuggestions, _this4.state.currentValue.toLowerCase());\n  };\n\n  this.setValue = function (value) {\n    var isDefaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var props = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _this4.props;\n    var category = arguments[3];\n    var cause = arguments[4]; // ignore state updates when component is locked\n\n    if (props.beforeValueChange && _this4.locked) {\n      return;\n    }\n\n    _this4.locked = true;\n\n    var performUpdate = function performUpdate() {\n      _this4.setState({\n        currentValue: value,\n        suggestions: []\n      }, function () {\n        if (isDefaultValue) {\n          if (_this4.props.autosuggest) {\n            _this4.setState({\n              isOpen: false\n            });\n\n            _this4.updateQuery(_this4.internalComponent, value, props);\n          } // in case of strict selection only SUGGESTION_SELECT should be able\n          // to set the query otherwise the value should reset\n\n\n          if (props.strictSelection) {\n            if (cause === _causes2.default.SUGGESTION_SELECT || value === '') {\n              _this4.updateQuery(props.componentId, value, props, category);\n            } else {\n              _this4.setValue('', true);\n            }\n          } else {\n            _this4.updateQuery(props.componentId, value, props, category);\n          }\n        } else {\n          // debounce for handling text while typing\n          _this4.handleTextChange(value);\n        }\n\n        _this4.locked = false;\n        if (props.onValueChange) props.onValueChange(value);\n      });\n    };\n\n    (0, _helper.checkValueChange)(props.componentId, value, props.beforeValueChange, performUpdate);\n  };\n\n  this.handleTextChange = (0, _helper.debounce)(function (value) {\n    if (_this4.props.autosuggest) {\n      _this4.updateQuery(_this4.internalComponent, value, _this4.props);\n    } else {\n      _this4.updateQuery(_this4.props.componentId, value, _this4.props);\n    }\n  }, this.props.debounce);\n\n  this.updateQuery = function (componentId, value, props, category) {\n    var customQuery = props.customQuery,\n        defaultQuery = props.defaultQuery,\n        filterLabel = props.filterLabel,\n        showFilter = props.showFilter,\n        URLParams = props.URLParams; // defaultQuery from props is always appended regardless of a customQuery\n\n    var query = customQuery || CategorySearch.defaultQuery;\n    var queryObject = defaultQuery ? {\n      bool: {\n        must: [].concat(query(value, props, category), defaultQuery(value, props, category))\n      } // prettier-ignore\n\n    } : query(value, props, category);\n    props.updateQuery({\n      componentId: componentId,\n      query: queryObject,\n      value: value,\n      label: filterLabel,\n      showFilter: showFilter,\n      URLParams: URLParams,\n      componentType: 'CATEGORYSEARCH'\n    });\n  };\n\n  this.handleFocus = function (event) {\n    _this4.setState({\n      isOpen: true\n    });\n\n    if (_this4.props.onFocus) {\n      _this4.props.onFocus(event);\n    }\n  };\n\n  this.clearValue = function () {\n    _this4.setValue('', true);\n\n    _this4.onValueSelected(null, _causes2.default.CLEAR_VALUE);\n  };\n\n  this.handleKeyDown = function (event, highlightedIndex) {\n    // if a suggestion was selected, delegate the handling to suggestion handler\n    if (event.key === 'Enter' && highlightedIndex === null) {\n      _this4.setValue(event.target.value, true);\n\n      _this4.onValueSelected(event.target.value, _causes2.default.ENTER_PRESS);\n    }\n\n    if (_this4.props.onKeyDown) {\n      _this4.props.onKeyDown(event);\n    }\n  };\n\n  this.onInputChange = function (e) {\n    var value = e.target.value;\n\n    if (!_this4.state.isOpen) {\n      _this4.setState({\n        isOpen: true\n      });\n    }\n\n    _this4.setValue(value);\n  };\n\n  this.onSuggestionSelected = function (suggestion) {\n    _this4.setValue(suggestion.value, true, _this4.props, suggestion.category, _causes2.default.SUGGESTION_SELECT);\n\n    _this4.onValueSelected(suggestion.value, suggestion.category, _causes2.default.SUGGESTION_SELECT, suggestion.source);\n  };\n\n  this.onValueSelected = function () {\n    for (var _len = arguments.length, cause = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      cause[_key - 2] = arguments[_key];\n    }\n\n    var currentValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this4.state.currentValue;\n    var category = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var onValueSelected = _this4.props.onValueSelected;\n\n    if (onValueSelected) {\n      onValueSelected.apply(undefined, [currentValue, category].concat(cause));\n    }\n  };\n\n  this.handleStateChange = function (changes) {\n    var isOpen = changes.isOpen,\n        type = changes.type;\n\n    if (type === _downshift2.default.stateChangeTypes.mouseUp) {\n      _this4.setState({\n        isOpen: isOpen\n      });\n    }\n  };\n\n  this.getBackgroundColor = function (highlightedIndex, index) {\n    var isDark = _this4.props.themePreset === 'dark';\n\n    if (isDark) {\n      return highlightedIndex === index ? '#555' : '#424242';\n    }\n\n    return highlightedIndex === index ? '#eee' : '#fff';\n  };\n\n  this.handleSearchIconClick = function () {\n    var currentValue = _this4.state.currentValue;\n\n    if (currentValue.trim()) {\n      _this4.setValue(currentValue, true);\n    }\n  };\n\n  this.renderIcon = function () {\n    if (_this4.props.showIcon) {\n      return _this4.props.icon || _react2.default.createElement(_SearchSvg2.default, null);\n    }\n\n    return null;\n  };\n\n  this.renderCancelIcon = function () {\n    if (_this4.props.showClear) {\n      return _this4.props.clearIcon || _react2.default.createElement(_CancelSvg2.default, null);\n    }\n\n    return null;\n  };\n\n  this.renderIcons = function () {\n    return _react2.default.createElement('div', null, _this4.state.currentValue && _this4.props.showClear && _react2.default.createElement(_InputIcon2.default, {\n      onClick: _this4.clearValue,\n      iconPosition: 'right',\n      clearIcon: _this4.props.iconPosition === 'right'\n    }, _this4.renderCancelIcon()), _react2.default.createElement(_InputIcon2.default, {\n      onClick: _this4.handleSearchIconClick,\n      iconPosition: _this4.props.iconPosition\n    }, _this4.renderIcon()));\n  };\n\n  this.renderLoader = function () {\n    var _props2 = _this4.props,\n        loader = _props2.loader,\n        isLoading = _props2.isLoading,\n        themePreset = _props2.themePreset,\n        theme = _props2.theme;\n    var currentValue = _this4.state.currentValue;\n\n    if (isLoading && loader && currentValue) {\n      return _react2.default.createElement('div', {\n        className: (0, _Input.noSuggestions)(themePreset, theme) + ' ' + (0, _helper.getClassName)(_this4.props.innerClass, 'no-suggestion')\n      }, _react2.default.createElement('li', null, loader));\n    }\n\n    return null;\n  };\n};\n\nCategorySearch.propTypes = {\n  addComponent: _types2.default.funcRequired,\n  removeComponent: _types2.default.funcRequired,\n  setQueryListener: _types2.default.funcRequired,\n  setQueryOptions: _types2.default.funcRequired,\n  updateQuery: _types2.default.funcRequired,\n  watchComponent: _types2.default.funcRequired,\n  options: _types2.default.options,\n  categories: _types2.default.data,\n  selectedValue: _types2.default.selectedValue,\n  suggestions: _types2.default.suggestions,\n  // component props\n  autoFocus: _types2.default.bool,\n  autosuggest: _types2.default.bool,\n  beforeValueChange: _types2.default.func,\n  categoryField: _types2.default.string,\n  className: _types2.default.string,\n  clearIcon: _types2.default.children,\n  componentId: _types2.default.stringRequired,\n  customHighlight: _types2.default.func,\n  customQuery: _types2.default.func,\n  dataField: _types2.default.dataFieldArray,\n  debounce: _types2.default.number,\n  defaultSelected: _types2.default.string,\n  defaultSuggestions: _types2.default.suggestions,\n  downShiftProps: _types2.default.props,\n  fieldWeights: _types2.default.fieldWeights,\n  filterLabel: _types2.default.string,\n  fuzziness: _types2.default.fuzziness,\n  highlight: _types2.default.bool,\n  highlightField: _types2.default.stringOrArray,\n  icon: _types2.default.children,\n  iconPosition: _types2.default.iconPosition,\n  innerClass: _types2.default.style,\n  innerRef: _types2.default.func,\n  isLoading: _types2.default.bool,\n  loader: _types2.default.title,\n  onBlur: _types2.default.func,\n  onFocus: _types2.default.func,\n  onKeyDown: _types2.default.func,\n  onKeyPress: _types2.default.func,\n  onKeyUp: _types2.default.func,\n  onQueryChange: _types2.default.func,\n  onSuggestion: _types2.default.func,\n  onValueChange: _types2.default.func,\n  onValueSelected: _types2.default.func,\n  placeholder: _types2.default.string,\n  queryFormat: _types2.default.queryFormatSearch,\n  react: _types2.default.react,\n  renderSuggestions: _types2.default.func,\n  showClear: _types2.default.bool,\n  showFilter: _types2.default.bool,\n  showIcon: _types2.default.bool,\n  style: _types2.default.style,\n  title: _types2.default.title,\n  theme: _types2.default.style,\n  themePreset: _types2.default.themePreset,\n  URLParams: _types2.default.bool,\n  strictSelection: _types2.default.bool\n};\nCategorySearch.defaultProps = {\n  autosuggest: true,\n  className: null,\n  debounce: 0,\n  downShiftProps: {},\n  iconPosition: 'left',\n  placeholder: 'Search',\n  queryFormat: 'or',\n  showClear: false,\n  showFilter: true,\n  showIcon: true,\n  style: {},\n  URLParams: false,\n  strictSelection: false\n};\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  return {\n    categories: state.aggregations[props.componentId] && state.aggregations[props.componentId][props.categoryField] && state.aggregations[props.componentId][props.categoryField].buckets || [],\n    selectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n    suggestions: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n    themePreset: state.config.themePreset,\n    isLoading: state.isLoading[props.componentId]\n  };\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n  return {\n    addComponent: function addComponent(component, name) {\n      return dispatch((0, _actions.addComponent)(component, name));\n    },\n    removeComponent: function removeComponent(component) {\n      return dispatch((0, _actions.removeComponent)(component));\n    },\n    setQueryOptions: function setQueryOptions(component, props, execute) {\n      return dispatch((0, _actions.setQueryOptions)(component, props, execute));\n    },\n    setQueryListener: function setQueryListener(component, onQueryChange, beforeQueryChange) {\n      return dispatch((0, _actions.setQueryListener)(component, onQueryChange, beforeQueryChange));\n    },\n    updateQuery: function updateQuery(updateQueryObject) {\n      return dispatch((0, _actions.updateQuery)(updateQueryObject));\n    },\n    watchComponent: function watchComponent(component, react) {\n      return dispatch((0, _actions.watchComponent)(component, react));\n    }\n  };\n};\n\nexports.default = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)((0, _emotionTheming.withTheme)(CategorySearch));","map":{"version":3,"sources":["C:/Users/porto/info340-code/pod/340/node_modules/@appbaseio/reactivesearch/lib/components/search/CategorySearch.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_react","require","_react2","_interopRequireDefault","_downshift","_downshift2","_emotionTheming","_actions","_helper","_types","_types2","_suggestions","_suggestions2","_causes","_causes2","_Title","_Title2","_Input","_Input2","_CancelSvg","_CancelSvg2","_SearchSvg","_SearchSvg2","_InputIcon","_InputIcon2","_Container","_Container2","_utils","obj","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","Text","withTheme","props","createElement","className","style","color","primary","theme","colors","primaryColor","textColor","children","CategorySearch","_Component","_this","_initialiseProps","state","currentValue","suggestions","isOpen","internalComponent","componentId","locked","setQueryListener","onQueryChange","componentWillMount","addComponent","highlight","queryOptions","highlightQuery","size","setQueryOptions","setReact","aggsQuery","getAggsQuery","categoryField","selectedValue","setValue","defaultSelected","componentWillReceiveProps","nextProps","_this2","checkSomePropChange","checkPropChange","react","Array","isArray","trim","setState","onSuggestions","updateQuery","componentWillUnmount","removeComponent","render","_this3","suggestionsList","finalSuggestionsList","_props","themePreset","renderSuggestions","categories","filteredCategories","filter","category","Boolean","defaultSuggestions","categorySuggestions","label","concat","title","getClassName","innerClass","autosuggest","id","onChange","onSuggestionSelected","onStateChange","handleStateChange","itemToString","_ref","getInputProps","getItemProps","highlightedIndex","suggestionsContainer","showClear","showIcon","iconPosition","innerRef","placeholder","onInputChange","onBlur","onFocus","handleFocus","onKeyPress","onKeyDown","e","handleKeyDown","onKeyUp","renderIcons","renderLoader","parsedSuggestions","slice","map","item","index","backgroundColor","getBackgroundColor","downShiftProps","autoFocus","Component","customHighlight","fields","highlightField","dataField","forEach","pre_tags","post_tags","defaultQuery","finalQuery","bool","should","shouldQuery","minimum_should_match","_term","term","match_all","dataFields","field","fieldWeights","queryFormat","multi_match","query","type","operator","fuzziness","_this4","_aggs","aggs","terms","newReact","pushToAndClause","watchComponent","and","searchSuggestions","onSuggestion","suggestion","toLowerCase","isDefaultValue","undefined","cause","beforeValueChange","performUpdate","strictSelection","SUGGESTION_SELECT","handleTextChange","onValueChange","checkValueChange","debounce","customQuery","filterLabel","showFilter","URLParams","queryObject","must","componentType","event","clearValue","onValueSelected","CLEAR_VALUE","ENTER_PRESS","_len","_key","apply","changes","stateChangeTypes","mouseUp","isDark","handleSearchIconClick","renderIcon","icon","renderCancelIcon","clearIcon","onClick","_props2","loader","isLoading","noSuggestions","propTypes","funcRequired","options","data","func","string","stringRequired","dataFieldArray","number","stringOrArray","queryFormatSearch","defaultProps","mapStateToProps","aggregations","buckets","selectedValues","hits","config","mapDispatchtoProps","dispatch","component","name","execute","beforeQueryChange","updateQueryObject","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _downshift = require('downshift');\n\nvar _downshift2 = _interopRequireDefault(_downshift);\n\nvar _emotionTheming = require('emotion-theming');\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _suggestions = require('@appbaseio/reactivecore/lib/utils/suggestions');\n\nvar _suggestions2 = _interopRequireDefault(_suggestions);\n\nvar _causes = require('@appbaseio/reactivecore/lib/utils/causes');\n\nvar _causes2 = _interopRequireDefault(_causes);\n\nvar _Title = require('../../styles/Title');\n\nvar _Title2 = _interopRequireDefault(_Title);\n\nvar _Input = require('../../styles/Input');\n\nvar _Input2 = _interopRequireDefault(_Input);\n\nvar _CancelSvg = require('../shared/CancelSvg');\n\nvar _CancelSvg2 = _interopRequireDefault(_CancelSvg);\n\nvar _SearchSvg = require('../shared/SearchSvg');\n\nvar _SearchSvg2 = _interopRequireDefault(_SearchSvg);\n\nvar _InputIcon = require('../../styles/InputIcon');\n\nvar _InputIcon2 = _interopRequireDefault(_InputIcon);\n\nvar _Container = require('../../styles/Container');\n\nvar _Container2 = _interopRequireDefault(_Container);\n\nvar _utils = require('../../utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Text = (0, _emotionTheming.withTheme)(function (props) {\n\treturn _react2.default.createElement(\n\t\t'span',\n\t\t{\n\t\t\tclassName: 'trim',\n\t\t\tstyle: {\n\t\t\t\tcolor: props.primary ? props.theme.colors.primaryColor : props.theme.colors.textColor\n\t\t\t}\n\t\t},\n\t\tprops.children\n\t);\n});\n\nvar CategorySearch = function (_Component) {\n\t_inherits(CategorySearch, _Component);\n\n\tfunction CategorySearch(props) {\n\t\t_classCallCheck(this, CategorySearch);\n\n\t\tvar _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n\t\t_initialiseProps.call(_this);\n\n\t\t_this.state = {\n\t\t\tcurrentValue: '',\n\t\t\tsuggestions: [],\n\t\t\tisOpen: false\n\t\t};\n\t\t_this.internalComponent = props.componentId + '__internal';\n\t\t_this.locked = false;\n\t\tprops.setQueryListener(props.componentId, props.onQueryChange, null);\n\t\treturn _this;\n\t}\n\n\tCategorySearch.prototype.componentWillMount = function componentWillMount() {\n\t\tthis.props.addComponent(this.props.componentId, 'CATEGORYSEARCH');\n\t\tthis.props.addComponent(this.internalComponent);\n\n\t\tif (this.props.highlight) {\n\t\t\tvar queryOptions = CategorySearch.highlightQuery(this.props) || {};\n\t\t\tqueryOptions.size = 20;\n\t\t\tthis.props.setQueryOptions(this.props.componentId, queryOptions);\n\t\t} else {\n\t\t\tthis.props.setQueryOptions(this.props.componentId, {\n\t\t\t\tsize: 20\n\t\t\t});\n\t\t}\n\t\tthis.setReact(this.props);\n\n\t\tvar aggsQuery = this.getAggsQuery(this.props.categoryField);\n\t\tthis.props.setQueryOptions(this.internalComponent, aggsQuery, false);\n\n\t\tif (this.props.selectedValue) {\n\t\t\tthis.setValue(this.props.selectedValue, true);\n\t\t} else if (this.props.defaultSelected) {\n\t\t\tthis.setValue(this.props.defaultSelected, true);\n\t\t}\n\t};\n\n\tCategorySearch.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n\t\tvar _this2 = this;\n\n\t\t(0, _helper.checkSomePropChange)(this.props, nextProps, ['highlight', 'dataField', 'highlightField'], function () {\n\t\t\tvar queryOptions = CategorySearch.highlightQuery(nextProps) || {};\n\t\t\tqueryOptions.size = 20;\n\t\t\t_this2.props.setQueryOptions(nextProps.componentId, queryOptions);\n\t\t});\n\n\t\t(0, _helper.checkPropChange)(this.props.react, nextProps.react, function () {\n\t\t\treturn _this2.setReact(nextProps);\n\t\t});\n\n\t\tif (Array.isArray(nextProps.suggestions) && this.state.currentValue.trim().length) {\n\t\t\t// shallow check allows us to set suggestions even if the next set\n\t\t\t// of suggestions are same as the current one\n\t\t\tif (this.props.suggestions !== nextProps.suggestions) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tsuggestions: this.onSuggestions(nextProps.suggestions)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t(0, _helper.checkSomePropChange)(this.props, nextProps, ['fieldWeights', 'fuzziness', 'queryFormat', 'dataField', 'categoryField'], function () {\n\t\t\t_this2.updateQuery(nextProps.componentId, _this2.state.currentValue, nextProps);\n\t\t});\n\n\t\tif (this.props.defaultSelected !== nextProps.defaultSelected) {\n\t\t\tthis.setValue(nextProps.defaultSelected, true, nextProps);\n\t\t} else if (\n\t\t// since, selectedValue will be updated when currentValue changes,\n\t\t// we must only check for the changes introduced by\n\t\t// clear action from SelectedFilters component in which case,\n\t\t// the currentValue will never match the updated selectedValue\n\t\tthis.props.selectedValue !== nextProps.selectedValue && this.state.currentValue !== nextProps.selectedValue) {\n\t\t\tthis.setValue(nextProps.selectedValue || '', true, nextProps);\n\t\t}\n\t};\n\n\tCategorySearch.prototype.componentWillUnmount = function componentWillUnmount() {\n\t\tthis.props.removeComponent(this.props.componentId);\n\t\tthis.props.removeComponent(this.internalComponent);\n\t};\n\n\tCategorySearch.prototype.render = function render() {\n\t\tvar _this3 = this;\n\n\t\tvar suggestionsList = [];\n\t\tvar finalSuggestionsList = [];\n\t\tvar _props = this.props,\n\t\t    theme = _props.theme,\n\t\t    themePreset = _props.themePreset,\n\t\t    renderSuggestions = _props.renderSuggestions,\n\t\t    categories = _props.categories;\n\n\t\t// filter out empty categories\n\n\t\tvar filteredCategories = categories.filter(function (category) {\n\t\t\treturn Boolean(category.key);\n\t\t});\n\n\t\tif (!this.state.currentValue && this.props.defaultSuggestions && this.props.defaultSuggestions.length) {\n\t\t\tfinalSuggestionsList = this.props.defaultSuggestions;\n\t\t} else if (this.state.currentValue) {\n\t\t\tsuggestionsList = this.state.suggestions;\n\t\t}\n\n\t\tif (this.state.currentValue && this.state.suggestions.length && filteredCategories.length) {\n\t\t\tvar categorySuggestions = [{\n\t\t\t\tlabel: this.state.currentValue + ' in all categories',\n\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\tcategory: '*',\n\t\t\t\t// no source object exists for category based suggestions\n\t\t\t\tsource: null\n\t\t\t}, {\n\t\t\t\tlabel: this.state.currentValue + ' in ' + filteredCategories[0].key,\n\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\tcategory: filteredCategories[0].key,\n\t\t\t\tsource: null\n\t\t\t}];\n\n\t\t\tif (filteredCategories.length > 1) {\n\t\t\t\tcategorySuggestions = [].concat(categorySuggestions, [{\n\t\t\t\t\tlabel: this.state.currentValue + ' in ' + filteredCategories[1].key,\n\t\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\t\tcategory: filteredCategories[1].key,\n\t\t\t\t\tsource: null\n\t\t\t\t}]);\n\t\t\t}\n\t\t\tfinalSuggestionsList = [].concat(categorySuggestions, suggestionsList);\n\t\t}\n\n\t\treturn _react2.default.createElement(\n\t\t\t_Container2.default,\n\t\t\t{ style: this.props.style, className: this.props.className },\n\t\t\tthis.props.title && _react2.default.createElement(\n\t\t\t\t_Title2.default,\n\t\t\t\t{ className: (0, _helper.getClassName)(this.props.innerClass, 'title') || null },\n\t\t\t\tthis.props.title\n\t\t\t),\n\t\t\tthis.props.defaultSuggestions || this.props.autosuggest ? _react2.default.createElement(_downshift2.default, _extends({\n\t\t\t\tid: this.props.componentId + '-downshift',\n\t\t\t\tonChange: this.onSuggestionSelected,\n\t\t\t\tonStateChange: this.handleStateChange,\n\t\t\t\tisOpen: this.state.isOpen,\n\t\t\t\titemToString: function itemToString(i) {\n\t\t\t\t\treturn i;\n\t\t\t\t},\n\t\t\t\trender: function render(_ref) {\n\t\t\t\t\tvar getInputProps = _ref.getInputProps,\n\t\t\t\t\t    getItemProps = _ref.getItemProps,\n\t\t\t\t\t    isOpen = _ref.isOpen,\n\t\t\t\t\t    highlightedIndex = _ref.highlightedIndex;\n\t\t\t\t\treturn _react2.default.createElement(\n\t\t\t\t\t\t'div',\n\t\t\t\t\t\t{ className: _Input.suggestionsContainer },\n\t\t\t\t\t\t_react2.default.createElement(_Input2.default, _extends({\n\t\t\t\t\t\t\tshowClear: _this3.props.showClear,\n\t\t\t\t\t\t\tid: _this3.props.componentId + '-input',\n\t\t\t\t\t\t\tshowIcon: _this3.props.showIcon,\n\t\t\t\t\t\t\ticonPosition: _this3.props.iconPosition,\n\t\t\t\t\t\t\tinnerRef: _this3.props.innerRef\n\t\t\t\t\t\t}, getInputProps({\n\t\t\t\t\t\t\tclassName: (0, _helper.getClassName)(_this3.props.innerClass, 'input'),\n\t\t\t\t\t\t\tplaceholder: _this3.props.placeholder,\n\t\t\t\t\t\t\tvalue: _this3.state.currentValue === null ? '' : _this3.state.currentValue,\n\t\t\t\t\t\t\tonChange: _this3.onInputChange,\n\t\t\t\t\t\t\tonBlur: _this3.props.onBlur,\n\t\t\t\t\t\t\tonFocus: _this3.handleFocus,\n\t\t\t\t\t\t\tonKeyPress: _this3.props.onKeyPress,\n\t\t\t\t\t\t\tonKeyDown: function onKeyDown(e) {\n\t\t\t\t\t\t\t\treturn _this3.handleKeyDown(e, highlightedIndex);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonKeyUp: _this3.props.onKeyUp\n\t\t\t\t\t\t}), {\n\t\t\t\t\t\t\tthemePreset: themePreset\n\t\t\t\t\t\t})),\n\t\t\t\t\t\t_this3.renderIcons(),\n\t\t\t\t\t\t_this3.renderLoader(),\n\t\t\t\t\t\trenderSuggestions && renderSuggestions({\n\t\t\t\t\t\t\tcurrentValue: _this3.state.currentValue,\n\t\t\t\t\t\t\tisOpen: isOpen,\n\t\t\t\t\t\t\tgetItemProps: getItemProps,\n\t\t\t\t\t\t\thighlightedIndex: highlightedIndex,\n\t\t\t\t\t\t\tsuggestions: _this3.props.suggestions,\n\t\t\t\t\t\t\tcategories: filteredCategories,\n\t\t\t\t\t\t\tparsedSuggestions: suggestionsList\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t!renderSuggestions && isOpen && finalSuggestionsList.length ? _react2.default.createElement(\n\t\t\t\t\t\t\t'ul',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: (0, _Input.suggestions)(themePreset, theme) + ' ' + (0, _helper.getClassName)(_this3.props.innerClass, 'list')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfinalSuggestionsList.slice(0, 10).map(function (item, index) {\n\t\t\t\t\t\t\t\treturn _react2.default.createElement(\n\t\t\t\t\t\t\t\t\t'li',\n\t\t\t\t\t\t\t\t\t_extends({}, getItemProps({ item: item }), {\n\t\t\t\t\t\t\t\t\t\tkey: index + 1 + '-' + item.value,\n\t\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: _this3.getBackgroundColor(highlightedIndex, index)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t\t\t\t\tText,\n\t\t\t\t\t\t\t\t\t\t{ primary: !!item.category },\n\t\t\t\t\t\t\t\t\t\titem.label\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t) : null\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}, this.props.downShiftProps)) : _react2.default.createElement(\n\t\t\t\t'div',\n\t\t\t\t{ className: _Input.suggestionsContainer },\n\t\t\t\t_react2.default.createElement(_Input2.default, {\n\t\t\t\t\tclassName: (0, _helper.getClassName)(this.props.innerClass, 'input'),\n\t\t\t\t\tplaceholder: this.props.placeholder,\n\t\t\t\t\tvalue: this.state.currentValue ? this.state.currentValue : '',\n\t\t\t\t\tonChange: this.onInputChange,\n\t\t\t\t\tonBlur: this.props.onBlur,\n\t\t\t\t\tonFocus: this.props.onFocus,\n\t\t\t\t\tonKeyPress: this.props.onKeyPress,\n\t\t\t\t\tonKeyDown: this.props.onKeyDown,\n\t\t\t\t\tonKeyUp: this.props.onKeyUp,\n\t\t\t\t\tautoFocus: this.props.autoFocus,\n\t\t\t\t\ticonPosition: this.props.iconPosition,\n\t\t\t\t\tshowClear: this.props.showClear,\n\t\t\t\t\tshowIcon: this.props.showIcon,\n\t\t\t\t\tinnerRef: this.props.innerRef,\n\t\t\t\t\tthemePreset: themePreset\n\t\t\t\t}),\n\t\t\t\tthis.renderIcons()\n\t\t\t)\n\t\t);\n\t};\n\n\treturn CategorySearch;\n}(_react.Component);\n\nCategorySearch.highlightQuery = function (props) {\n\tif (props.customHighlight) {\n\t\treturn props.customHighlight(props);\n\t}\n\tif (!props.highlight) {\n\t\treturn null;\n\t}\n\tvar fields = {};\n\tvar highlightField = props.highlightField ? props.highlightField : props.dataField;\n\n\tif (typeof highlightField === 'string') {\n\t\tfields[highlightField] = {};\n\t} else if (Array.isArray(highlightField)) {\n\t\thighlightField.forEach(function (item) {\n\t\t\tfields[item] = {};\n\t\t});\n\t}\n\n\treturn {\n\t\thighlight: {\n\t\t\tpre_tags: ['<mark>'],\n\t\t\tpost_tags: ['</mark>'],\n\t\t\tfields: fields\n\t\t}\n\t};\n};\n\nCategorySearch.defaultQuery = function (value, props, category) {\n\tvar finalQuery = null;\n\tvar fields = void 0;\n\n\tif (value) {\n\t\tif (Array.isArray(props.dataField)) {\n\t\t\tfields = props.dataField;\n\t\t} else {\n\t\t\tfields = [props.dataField];\n\t\t}\n\t\tfinalQuery = {\n\t\t\tbool: {\n\t\t\t\tshould: CategorySearch.shouldQuery(value, fields, props),\n\t\t\t\tminimum_should_match: '1'\n\t\t\t}\n\t\t};\n\n\t\tif (category && category !== '*') {\n\t\t\tvar _term;\n\n\t\t\tfinalQuery = [finalQuery, {\n\t\t\t\tterm: (_term = {}, _term[props.categoryField] = category, _term)\n\t\t\t}];\n\t\t}\n\t}\n\n\tif (value === '') {\n\t\tfinalQuery = {\n\t\t\tmatch_all: {}\n\t\t};\n\t}\n\n\treturn finalQuery;\n};\n\nCategorySearch.shouldQuery = function (value, dataFields, props) {\n\tvar fields = dataFields.map(function (field, index) {\n\t\treturn '' + field + (Array.isArray(props.fieldWeights) && props.fieldWeights[index] ? '^' + props.fieldWeights[index] : '');\n\t});\n\n\tif (props.queryFormat === 'and') {\n\t\treturn [{\n\t\t\tmulti_match: {\n\t\t\t\tquery: value,\n\t\t\t\tfields: fields,\n\t\t\t\ttype: 'cross_fields',\n\t\t\t\toperator: 'and'\n\t\t\t}\n\t\t}, {\n\t\t\tmulti_match: {\n\t\t\t\tquery: value,\n\t\t\t\tfields: fields,\n\t\t\t\ttype: 'phrase_prefix',\n\t\t\t\toperator: 'and'\n\t\t\t}\n\t\t}];\n\t}\n\n\treturn [{\n\t\tmulti_match: {\n\t\t\tquery: value,\n\t\t\tfields: fields,\n\t\t\ttype: 'best_fields',\n\t\t\toperator: 'or',\n\t\t\tfuzziness: props.fuzziness ? props.fuzziness : 0\n\t\t}\n\t}, {\n\t\tmulti_match: {\n\t\t\tquery: value,\n\t\t\tfields: fields,\n\t\t\ttype: 'phrase_prefix',\n\t\t\toperator: 'or'\n\t\t}\n\t}];\n};\n\nvar _initialiseProps = function _initialiseProps() {\n\tvar _this4 = this;\n\n\tthis.getAggsQuery = function (field) {\n\t\tvar _aggs;\n\n\t\treturn {\n\t\t\taggs: (_aggs = {}, _aggs[field] = {\n\t\t\t\tterms: {\n\t\t\t\t\tfield: field\n\t\t\t\t}\n\t\t\t}, _aggs)\n\t\t};\n\t};\n\n\tthis.setReact = function (props) {\n\t\tvar react = props.react;\n\n\t\tif (react) {\n\t\t\tvar newReact = (0, _helper.pushToAndClause)(react, _this4.internalComponent);\n\t\t\tprops.watchComponent(props.componentId, newReact);\n\t\t} else {\n\t\t\tprops.watchComponent(props.componentId, {\n\t\t\t\tand: _this4.internalComponent\n\t\t\t});\n\t\t}\n\t};\n\n\tthis.onSuggestions = function (searchSuggestions) {\n\t\tif (_this4.props.onSuggestion) {\n\t\t\treturn searchSuggestions.map(function (suggestion) {\n\t\t\t\treturn _this4.props.onSuggestion(suggestion);\n\t\t\t});\n\t\t}\n\n\t\tvar fields = Array.isArray(_this4.props.dataField) ? _this4.props.dataField : [_this4.props.dataField];\n\n\t\treturn (0, _suggestions2.default)(fields, searchSuggestions, _this4.state.currentValue.toLowerCase());\n\t};\n\n\tthis.setValue = function (value) {\n\t\tvar isDefaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\tvar props = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _this4.props;\n\t\tvar category = arguments[3];\n\t\tvar cause = arguments[4];\n\n\t\t// ignore state updates when component is locked\n\t\tif (props.beforeValueChange && _this4.locked) {\n\t\t\treturn;\n\t\t}\n\n\t\t_this4.locked = true;\n\t\tvar performUpdate = function performUpdate() {\n\t\t\t_this4.setState({\n\t\t\t\tcurrentValue: value,\n\t\t\t\tsuggestions: []\n\t\t\t}, function () {\n\t\t\t\tif (isDefaultValue) {\n\t\t\t\t\tif (_this4.props.autosuggest) {\n\t\t\t\t\t\t_this4.setState({\n\t\t\t\t\t\t\tisOpen: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\t_this4.updateQuery(_this4.internalComponent, value, props);\n\t\t\t\t\t}\n\t\t\t\t\t// in case of strict selection only SUGGESTION_SELECT should be able\n\t\t\t\t\t// to set the query otherwise the value should reset\n\t\t\t\t\tif (props.strictSelection) {\n\t\t\t\t\t\tif (cause === _causes2.default.SUGGESTION_SELECT || value === '') {\n\t\t\t\t\t\t\t_this4.updateQuery(props.componentId, value, props, category);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this4.setValue('', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this4.updateQuery(props.componentId, value, props, category);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// debounce for handling text while typing\n\t\t\t\t\t_this4.handleTextChange(value);\n\t\t\t\t}\n\t\t\t\t_this4.locked = false;\n\t\t\t\tif (props.onValueChange) props.onValueChange(value);\n\t\t\t});\n\t\t};\n\t\t(0, _helper.checkValueChange)(props.componentId, value, props.beforeValueChange, performUpdate);\n\t};\n\n\tthis.handleTextChange = (0, _helper.debounce)(function (value) {\n\t\tif (_this4.props.autosuggest) {\n\t\t\t_this4.updateQuery(_this4.internalComponent, value, _this4.props);\n\t\t} else {\n\t\t\t_this4.updateQuery(_this4.props.componentId, value, _this4.props);\n\t\t}\n\t}, this.props.debounce);\n\n\tthis.updateQuery = function (componentId, value, props, category) {\n\t\tvar customQuery = props.customQuery,\n\t\t    defaultQuery = props.defaultQuery,\n\t\t    filterLabel = props.filterLabel,\n\t\t    showFilter = props.showFilter,\n\t\t    URLParams = props.URLParams;\n\n\t\t// defaultQuery from props is always appended regardless of a customQuery\n\n\t\tvar query = customQuery || CategorySearch.defaultQuery;\n\t\tvar queryObject = defaultQuery ? {\n\t\t\tbool: {\n\t\t\t\tmust: [].concat(query(value, props, category), defaultQuery(value, props, category))\n\t\t\t} // prettier-ignore\n\t\t} : query(value, props, category);\n\t\tprops.updateQuery({\n\t\t\tcomponentId: componentId,\n\t\t\tquery: queryObject,\n\t\t\tvalue: value,\n\t\t\tlabel: filterLabel,\n\t\t\tshowFilter: showFilter,\n\t\t\tURLParams: URLParams,\n\t\t\tcomponentType: 'CATEGORYSEARCH'\n\t\t});\n\t};\n\n\tthis.handleFocus = function (event) {\n\t\t_this4.setState({\n\t\t\tisOpen: true\n\t\t});\n\t\tif (_this4.props.onFocus) {\n\t\t\t_this4.props.onFocus(event);\n\t\t}\n\t};\n\n\tthis.clearValue = function () {\n\t\t_this4.setValue('', true);\n\t\t_this4.onValueSelected(null, _causes2.default.CLEAR_VALUE);\n\t};\n\n\tthis.handleKeyDown = function (event, highlightedIndex) {\n\t\t// if a suggestion was selected, delegate the handling to suggestion handler\n\t\tif (event.key === 'Enter' && highlightedIndex === null) {\n\t\t\t_this4.setValue(event.target.value, true);\n\t\t\t_this4.onValueSelected(event.target.value, _causes2.default.ENTER_PRESS);\n\t\t}\n\t\tif (_this4.props.onKeyDown) {\n\t\t\t_this4.props.onKeyDown(event);\n\t\t}\n\t};\n\n\tthis.onInputChange = function (e) {\n\t\tvar value = e.target.value;\n\n\t\tif (!_this4.state.isOpen) {\n\t\t\t_this4.setState({\n\t\t\t\tisOpen: true\n\t\t\t});\n\t\t}\n\t\t_this4.setValue(value);\n\t};\n\n\tthis.onSuggestionSelected = function (suggestion) {\n\t\t_this4.setValue(suggestion.value, true, _this4.props, suggestion.category, _causes2.default.SUGGESTION_SELECT);\n\t\t_this4.onValueSelected(suggestion.value, suggestion.category, _causes2.default.SUGGESTION_SELECT, suggestion.source);\n\t};\n\n\tthis.onValueSelected = function () {\n\t\tfor (var _len = arguments.length, cause = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n\t\t\tcause[_key - 2] = arguments[_key];\n\t\t}\n\n\t\tvar currentValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this4.state.currentValue;\n\t\tvar category = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\tvar onValueSelected = _this4.props.onValueSelected;\n\n\t\tif (onValueSelected) {\n\t\t\tonValueSelected.apply(undefined, [currentValue, category].concat(cause));\n\t\t}\n\t};\n\n\tthis.handleStateChange = function (changes) {\n\t\tvar isOpen = changes.isOpen,\n\t\t    type = changes.type;\n\n\t\tif (type === _downshift2.default.stateChangeTypes.mouseUp) {\n\t\t\t_this4.setState({\n\t\t\t\tisOpen: isOpen\n\t\t\t});\n\t\t}\n\t};\n\n\tthis.getBackgroundColor = function (highlightedIndex, index) {\n\t\tvar isDark = _this4.props.themePreset === 'dark';\n\t\tif (isDark) {\n\t\t\treturn highlightedIndex === index ? '#555' : '#424242';\n\t\t}\n\t\treturn highlightedIndex === index ? '#eee' : '#fff';\n\t};\n\n\tthis.handleSearchIconClick = function () {\n\t\tvar currentValue = _this4.state.currentValue;\n\n\t\tif (currentValue.trim()) {\n\t\t\t_this4.setValue(currentValue, true);\n\t\t}\n\t};\n\n\tthis.renderIcon = function () {\n\t\tif (_this4.props.showIcon) {\n\t\t\treturn _this4.props.icon || _react2.default.createElement(_SearchSvg2.default, null);\n\t\t}\n\t\treturn null;\n\t};\n\n\tthis.renderCancelIcon = function () {\n\t\tif (_this4.props.showClear) {\n\t\t\treturn _this4.props.clearIcon || _react2.default.createElement(_CancelSvg2.default, null);\n\t\t}\n\t\treturn null;\n\t};\n\n\tthis.renderIcons = function () {\n\t\treturn _react2.default.createElement(\n\t\t\t'div',\n\t\t\tnull,\n\t\t\t_this4.state.currentValue && _this4.props.showClear && _react2.default.createElement(\n\t\t\t\t_InputIcon2.default,\n\t\t\t\t{\n\t\t\t\t\tonClick: _this4.clearValue,\n\t\t\t\t\ticonPosition: 'right',\n\t\t\t\t\tclearIcon: _this4.props.iconPosition === 'right'\n\t\t\t\t},\n\t\t\t\t_this4.renderCancelIcon()\n\t\t\t),\n\t\t\t_react2.default.createElement(\n\t\t\t\t_InputIcon2.default,\n\t\t\t\t{\n\t\t\t\t\tonClick: _this4.handleSearchIconClick,\n\t\t\t\t\ticonPosition: _this4.props.iconPosition\n\t\t\t\t},\n\t\t\t\t_this4.renderIcon()\n\t\t\t)\n\t\t);\n\t};\n\n\tthis.renderLoader = function () {\n\t\tvar _props2 = _this4.props,\n\t\t    loader = _props2.loader,\n\t\t    isLoading = _props2.isLoading,\n\t\t    themePreset = _props2.themePreset,\n\t\t    theme = _props2.theme;\n\t\tvar currentValue = _this4.state.currentValue;\n\n\t\tif (isLoading && loader && currentValue) {\n\t\t\treturn _react2.default.createElement(\n\t\t\t\t'div',\n\t\t\t\t{ className: (0, _Input.noSuggestions)(themePreset, theme) + ' ' + (0, _helper.getClassName)(_this4.props.innerClass, 'no-suggestion')\n\t\t\t\t},\n\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t'li',\n\t\t\t\t\tnull,\n\t\t\t\t\tloader\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n};\n\nCategorySearch.propTypes = {\n\taddComponent: _types2.default.funcRequired,\n\tremoveComponent: _types2.default.funcRequired,\n\tsetQueryListener: _types2.default.funcRequired,\n\tsetQueryOptions: _types2.default.funcRequired,\n\tupdateQuery: _types2.default.funcRequired,\n\twatchComponent: _types2.default.funcRequired,\n\toptions: _types2.default.options,\n\tcategories: _types2.default.data,\n\tselectedValue: _types2.default.selectedValue,\n\tsuggestions: _types2.default.suggestions,\n\t// component props\n\tautoFocus: _types2.default.bool,\n\tautosuggest: _types2.default.bool,\n\tbeforeValueChange: _types2.default.func,\n\tcategoryField: _types2.default.string,\n\tclassName: _types2.default.string,\n\tclearIcon: _types2.default.children,\n\tcomponentId: _types2.default.stringRequired,\n\tcustomHighlight: _types2.default.func,\n\tcustomQuery: _types2.default.func,\n\tdataField: _types2.default.dataFieldArray,\n\tdebounce: _types2.default.number,\n\tdefaultSelected: _types2.default.string,\n\tdefaultSuggestions: _types2.default.suggestions,\n\tdownShiftProps: _types2.default.props,\n\tfieldWeights: _types2.default.fieldWeights,\n\tfilterLabel: _types2.default.string,\n\tfuzziness: _types2.default.fuzziness,\n\thighlight: _types2.default.bool,\n\thighlightField: _types2.default.stringOrArray,\n\ticon: _types2.default.children,\n\ticonPosition: _types2.default.iconPosition,\n\tinnerClass: _types2.default.style,\n\tinnerRef: _types2.default.func,\n\tisLoading: _types2.default.bool,\n\tloader: _types2.default.title,\n\tonBlur: _types2.default.func,\n\tonFocus: _types2.default.func,\n\tonKeyDown: _types2.default.func,\n\tonKeyPress: _types2.default.func,\n\tonKeyUp: _types2.default.func,\n\tonQueryChange: _types2.default.func,\n\tonSuggestion: _types2.default.func,\n\tonValueChange: _types2.default.func,\n\tonValueSelected: _types2.default.func,\n\tplaceholder: _types2.default.string,\n\tqueryFormat: _types2.default.queryFormatSearch,\n\treact: _types2.default.react,\n\trenderSuggestions: _types2.default.func,\n\tshowClear: _types2.default.bool,\n\tshowFilter: _types2.default.bool,\n\tshowIcon: _types2.default.bool,\n\tstyle: _types2.default.style,\n\ttitle: _types2.default.title,\n\ttheme: _types2.default.style,\n\tthemePreset: _types2.default.themePreset,\n\tURLParams: _types2.default.bool,\n\tstrictSelection: _types2.default.bool\n};\n\nCategorySearch.defaultProps = {\n\tautosuggest: true,\n\tclassName: null,\n\tdebounce: 0,\n\tdownShiftProps: {},\n\ticonPosition: 'left',\n\tplaceholder: 'Search',\n\tqueryFormat: 'or',\n\tshowClear: false,\n\tshowFilter: true,\n\tshowIcon: true,\n\tstyle: {},\n\tURLParams: false,\n\tstrictSelection: false\n};\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n\treturn {\n\t\tcategories: state.aggregations[props.componentId] && state.aggregations[props.componentId][props.categoryField] && state.aggregations[props.componentId][props.categoryField].buckets || [],\n\t\tselectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n\t\tsuggestions: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n\t\tthemePreset: state.config.themePreset,\n\t\tisLoading: state.isLoading[props.componentId]\n\t};\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n\treturn {\n\t\taddComponent: function addComponent(component, name) {\n\t\t\treturn dispatch((0, _actions.addComponent)(component, name));\n\t\t},\n\t\tremoveComponent: function removeComponent(component) {\n\t\t\treturn dispatch((0, _actions.removeComponent)(component));\n\t\t},\n\t\tsetQueryOptions: function setQueryOptions(component, props, execute) {\n\t\t\treturn dispatch((0, _actions.setQueryOptions)(component, props, execute));\n\t\t},\n\t\tsetQueryListener: function setQueryListener(component, onQueryChange, beforeQueryChange) {\n\t\t\treturn dispatch((0, _actions.setQueryListener)(component, onQueryChange, beforeQueryChange));\n\t\t},\n\t\tupdateQuery: function updateQuery(updateQueryObject) {\n\t\t\treturn dispatch((0, _actions.updateQuery)(updateQueryObject));\n\t\t},\n\t\twatchComponent: function watchComponent(component, react) {\n\t\t\treturn dispatch((0, _actions.watchComponent)(component, react));\n\t\t}\n\t};\n};\n\nexports.default = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)((0, _emotionTheming.withTheme)(CategorySearch));"]},"metadata":{},"sourceType":"script"}