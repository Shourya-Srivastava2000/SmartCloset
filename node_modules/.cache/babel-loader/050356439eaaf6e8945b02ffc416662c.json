{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _Base = require('../../styles/Base');\n\nvar _Base2 = _interopRequireDefault(_Base);\n\nvar _utils = require('../../utils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar URLSearchParams = require('url-search-params');\n\nvar URLParamsProvider = function (_Component) {\n  _inherits(URLParamsProvider, _Component);\n\n  function URLParamsProvider() {\n    _classCallCheck(this, URLParamsProvider);\n\n    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n  }\n\n  URLParamsProvider.prototype.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    this.params = new URLSearchParams(window.location.search);\n    this.currentSelectedState = this.props.selectedValues || {};\n\n    window.onpopstate = function () {\n      var activeComponents = Array.from(_this2.params.keys()); // remove inactive components from selectedValues\n\n      Object.keys(_this2.currentSelectedState).filter(function (item) {\n        return !activeComponents.includes(item);\n      }).forEach(function (component) {\n        _this2.props.setValue(component, null);\n      }); // update active components in selectedValues\n\n      Array.from(_this2.params.entries()).forEach(function (item) {\n        try {\n          _this2.props.setValue(item[0], JSON.parse(item[1]));\n        } catch (e) {// Do not set value if JSON parsing fails.\n        }\n      });\n    };\n  };\n\n  URLParamsProvider.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    var _this3 = this;\n\n    this.currentSelectedState = nextProps.selectedValues;\n\n    if (!(0, _helper.isEqual)(this.props.selectedValues, nextProps.selectedValues)) {\n      this.params = new URLSearchParams(window.location.search);\n      var currentComponents = Object.keys(nextProps.selectedValues);\n      var urlComponents = Array.from(this.params.keys());\n      currentComponents.filter(function (component) {\n        return nextProps.selectedValues[component].URLParams;\n      }).forEach(function (component) {\n        // prevents empty history pollution on initial load\n        if (_this3.hasValidValue(_this3.props.selectedValues[component]) || _this3.hasValidValue(nextProps.selectedValues[component])) {\n          if (nextProps.selectedValues[component].URLParams) {\n            _this3.setURL(component, _this3.getValue(nextProps.selectedValues[component].value));\n          } else {\n            _this3.params.delete(component);\n\n            _this3.pushToHistory();\n          }\n        } else if (!_this3.hasValidValue(nextProps.selectedValues[component]) && urlComponents.includes(component)) {\n          // doesn't have a valid value, but the url has a (stale) valid value set\n          _this3.params.delete(component);\n\n          _this3.pushToHistory();\n        }\n      }); // remove unmounted components\n\n      Object.keys(this.props.selectedValues).filter(function (component) {\n        return !currentComponents.includes(component);\n      }).forEach(function (component) {\n        _this3.params.delete(component);\n\n        _this3.pushToHistory();\n      });\n\n      if (!currentComponents.length) {\n        Array.from(this.params.keys()).forEach(function (item) {\n          _this3.params.delete(item);\n        });\n        this.pushToHistory();\n      }\n    }\n\n    if (!(0, _helper.isEqual)(this.props.headers, nextProps.headers)) {\n      nextProps.setHeaders(nextProps.headers);\n    }\n  };\n\n  URLParamsProvider.prototype.hasValidValue = function hasValidValue(component) {\n    if (!component) return false;\n    if (Array.isArray(component.value)) return !!component.value.length;\n    return !!component.value;\n  };\n\n  URLParamsProvider.prototype.getValue = function getValue(value) {\n    var _this4 = this;\n\n    if (Array.isArray(value) && value.length) {\n      return value.map(function (item) {\n        return _this4.getValue(item);\n      });\n    } else if (value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n      // TODO: support for NestedList\n      if (value.location) return value;\n      return value.label || value.key || null;\n    }\n\n    return value;\n  };\n\n  URLParamsProvider.prototype.setURL = function setURL(component, value) {\n    this.params = new URLSearchParams(window.location.search);\n\n    if (!value || typeof value === 'string' && value.trim() === '' || Array.isArray(value) && value.length === 0) {\n      this.params.delete(component);\n      this.pushToHistory();\n    } else {\n      var data = JSON.stringify(this.getValue(value));\n\n      if (data !== this.params.get(component)) {\n        this.params.set(component, data);\n        this.pushToHistory();\n      }\n    }\n  };\n\n  URLParamsProvider.prototype.pushToHistory = function pushToHistory() {\n    if (window.history.pushState) {\n      var paramsSting = this.params.toString() ? '?' + this.params.toString() : '';\n      var base = window.location.href.split('?')[0];\n      var newurl = '' + base + paramsSting;\n      window.history.pushState({\n        path: newurl\n      }, '', newurl);\n    }\n  };\n\n  URLParamsProvider.prototype.render = function render() {\n    return _react2.default.createElement(_Base2.default, {\n      style: this.props.style,\n      className: this.props.className\n    }, this.props.children);\n  };\n\n  return URLParamsProvider;\n}(_react.Component);\n\nURLParamsProvider.propTypes = {\n  setHeaders: _types2.default.func,\n  setValue: _types2.default.func,\n  selectedValues: _types2.default.selectedValues,\n  // component props\n  children: _types2.default.children,\n  headers: _types2.default.headers,\n  style: _types2.default.style,\n  className: _types2.default.string\n};\nURLParamsProvider.defaultProps = {\n  style: {},\n  className: null\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    selectedValues: state.selectedValues\n  };\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n  return {\n    setHeaders: function setHeaders(headers) {\n      return dispatch((0, _actions.setHeaders)(headers));\n    },\n    setValue: function setValue(component, value, label, showFilter, URLParams) {\n      return dispatch((0, _actions.setValue)(component, value, label, showFilter, URLParams));\n    }\n  };\n};\n\nexports.default = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(URLParamsProvider);","map":{"version":3,"sources":["C:/Users/porto/info340-code/pod/340/node_modules/@appbaseio/reactivesearch/lib/components/basic/URLParamsProvider.js"],"names":["exports","__esModule","_typeof","Symbol","iterator","obj","constructor","prototype","_react","require","_react2","_interopRequireDefault","_actions","_types","_types2","_helper","_Base","_Base2","_utils","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","Object","create","value","enumerable","writable","configurable","setPrototypeOf","__proto__","URLSearchParams","URLParamsProvider","_Component","apply","arguments","componentDidMount","_this2","params","window","location","search","currentSelectedState","props","selectedValues","onpopstate","activeComponents","Array","from","keys","filter","item","includes","forEach","component","setValue","entries","JSON","parse","e","componentWillReceiveProps","nextProps","_this3","isEqual","currentComponents","urlComponents","URLParams","hasValidValue","setURL","getValue","delete","pushToHistory","length","headers","setHeaders","isArray","_this4","map","label","key","trim","data","stringify","get","set","history","pushState","paramsSting","toString","base","href","split","newurl","path","render","createElement","style","className","children","Component","propTypes","func","string","defaultProps","mapStateToProps","state","mapDispatchtoProps","dispatch","showFilter","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _Base = require('../../styles/Base');\n\nvar _Base2 = _interopRequireDefault(_Base);\n\nvar _utils = require('../../utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar URLSearchParams = require('url-search-params');\n\nvar URLParamsProvider = function (_Component) {\n\t_inherits(URLParamsProvider, _Component);\n\n\tfunction URLParamsProvider() {\n\t\t_classCallCheck(this, URLParamsProvider);\n\n\t\treturn _possibleConstructorReturn(this, _Component.apply(this, arguments));\n\t}\n\n\tURLParamsProvider.prototype.componentDidMount = function componentDidMount() {\n\t\tvar _this2 = this;\n\n\t\tthis.params = new URLSearchParams(window.location.search);\n\t\tthis.currentSelectedState = this.props.selectedValues || {};\n\t\twindow.onpopstate = function () {\n\t\t\tvar activeComponents = Array.from(_this2.params.keys());\n\n\t\t\t// remove inactive components from selectedValues\n\t\t\tObject.keys(_this2.currentSelectedState).filter(function (item) {\n\t\t\t\treturn !activeComponents.includes(item);\n\t\t\t}).forEach(function (component) {\n\t\t\t\t_this2.props.setValue(component, null);\n\t\t\t});\n\n\t\t\t// update active components in selectedValues\n\t\t\tArray.from(_this2.params.entries()).forEach(function (item) {\n\t\t\t\ttry {\n\t\t\t\t\t_this2.props.setValue(item[0], JSON.parse(item[1]));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Do not set value if JSON parsing fails.\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t};\n\n\tURLParamsProvider.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n\t\tvar _this3 = this;\n\n\t\tthis.currentSelectedState = nextProps.selectedValues;\n\t\tif (!(0, _helper.isEqual)(this.props.selectedValues, nextProps.selectedValues)) {\n\t\t\tthis.params = new URLSearchParams(window.location.search);\n\t\t\tvar currentComponents = Object.keys(nextProps.selectedValues);\n\t\t\tvar urlComponents = Array.from(this.params.keys());\n\n\t\t\tcurrentComponents.filter(function (component) {\n\t\t\t\treturn nextProps.selectedValues[component].URLParams;\n\t\t\t}).forEach(function (component) {\n\t\t\t\t// prevents empty history pollution on initial load\n\t\t\t\tif (_this3.hasValidValue(_this3.props.selectedValues[component]) || _this3.hasValidValue(nextProps.selectedValues[component])) {\n\t\t\t\t\tif (nextProps.selectedValues[component].URLParams) {\n\t\t\t\t\t\t_this3.setURL(component, _this3.getValue(nextProps.selectedValues[component].value));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this3.params.delete(component);\n\t\t\t\t\t\t_this3.pushToHistory();\n\t\t\t\t\t}\n\t\t\t\t} else if (!_this3.hasValidValue(nextProps.selectedValues[component]) && urlComponents.includes(component)) {\n\t\t\t\t\t// doesn't have a valid value, but the url has a (stale) valid value set\n\t\t\t\t\t_this3.params.delete(component);\n\t\t\t\t\t_this3.pushToHistory();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// remove unmounted components\n\t\t\tObject.keys(this.props.selectedValues).filter(function (component) {\n\t\t\t\treturn !currentComponents.includes(component);\n\t\t\t}).forEach(function (component) {\n\t\t\t\t_this3.params.delete(component);\n\t\t\t\t_this3.pushToHistory();\n\t\t\t});\n\n\t\t\tif (!currentComponents.length) {\n\t\t\t\tArray.from(this.params.keys()).forEach(function (item) {\n\t\t\t\t\t_this3.params.delete(item);\n\t\t\t\t});\n\t\t\t\tthis.pushToHistory();\n\t\t\t}\n\t\t}\n\n\t\tif (!(0, _helper.isEqual)(this.props.headers, nextProps.headers)) {\n\t\t\tnextProps.setHeaders(nextProps.headers);\n\t\t}\n\t};\n\n\tURLParamsProvider.prototype.hasValidValue = function hasValidValue(component) {\n\t\tif (!component) return false;\n\t\tif (Array.isArray(component.value)) return !!component.value.length;\n\t\treturn !!component.value;\n\t};\n\n\tURLParamsProvider.prototype.getValue = function getValue(value) {\n\t\tvar _this4 = this;\n\n\t\tif (Array.isArray(value) && value.length) {\n\t\t\treturn value.map(function (item) {\n\t\t\t\treturn _this4.getValue(item);\n\t\t\t});\n\t\t} else if (value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n\t\t\t// TODO: support for NestedList\n\t\t\tif (value.location) return value;\n\t\t\treturn value.label || value.key || null;\n\t\t}\n\t\treturn value;\n\t};\n\n\tURLParamsProvider.prototype.setURL = function setURL(component, value) {\n\t\tthis.params = new URLSearchParams(window.location.search);\n\t\tif (!value || typeof value === 'string' && value.trim() === '' || Array.isArray(value) && value.length === 0) {\n\t\t\tthis.params.delete(component);\n\t\t\tthis.pushToHistory();\n\t\t} else {\n\t\t\tvar data = JSON.stringify(this.getValue(value));\n\t\t\tif (data !== this.params.get(component)) {\n\t\t\t\tthis.params.set(component, data);\n\t\t\t\tthis.pushToHistory();\n\t\t\t}\n\t\t}\n\t};\n\n\tURLParamsProvider.prototype.pushToHistory = function pushToHistory() {\n\t\tif (window.history.pushState) {\n\t\t\tvar paramsSting = this.params.toString() ? '?' + this.params.toString() : '';\n\t\t\tvar base = window.location.href.split('?')[0];\n\t\t\tvar newurl = '' + base + paramsSting;\n\t\t\twindow.history.pushState({ path: newurl }, '', newurl);\n\t\t}\n\t};\n\n\tURLParamsProvider.prototype.render = function render() {\n\t\treturn _react2.default.createElement(\n\t\t\t_Base2.default,\n\t\t\t{ style: this.props.style, className: this.props.className },\n\t\t\tthis.props.children\n\t\t);\n\t};\n\n\treturn URLParamsProvider;\n}(_react.Component);\n\nURLParamsProvider.propTypes = {\n\tsetHeaders: _types2.default.func,\n\tsetValue: _types2.default.func,\n\tselectedValues: _types2.default.selectedValues,\n\t// component props\n\tchildren: _types2.default.children,\n\theaders: _types2.default.headers,\n\tstyle: _types2.default.style,\n\tclassName: _types2.default.string\n};\n\nURLParamsProvider.defaultProps = {\n\tstyle: {},\n\tclassName: null\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n\treturn {\n\t\tselectedValues: state.selectedValues\n\t};\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n\treturn {\n\t\tsetHeaders: function setHeaders(headers) {\n\t\t\treturn dispatch((0, _actions.setHeaders)(headers));\n\t\t},\n\t\tsetValue: function setValue(component, value, label, showFilter, URLParams) {\n\t\t\treturn dispatch((0, _actions.setValue)(component, value, label, showFilter, URLParams));\n\t\t}\n\t};\n};\n\nexports.default = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(URLParamsProvider);"]},"metadata":{},"sourceType":"script"}